{% extends "base.html" %}

{% block title %}Oyuncu Ä°statistikleri{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2>ğŸ“Š TakÄ±m OrtalamasÄ±ndan Uzun Oyuncular</h2>
        <a href="/players" class="btn btn-outline-secondary">â† Listeye DÃ¶n</a>
    </div>

    <div class="alert alert-info">
        Bu liste, kendi boyu <strong>takÄ±mÄ±nÄ±n boy ortalamasÄ±ndan</strong> (Advanced/Nested Query ile hesaplanmÄ±ÅŸtÄ±r)
        yÃ¼ksek olan oyuncularÄ± gÃ¶sterir.
    </div>

    <table class="table table-bordered table-striped">
        <thead class="table-dark">
            <tr>
                <th>Oyuncu AdÄ±</th>
                <th>TakÄ±m</th>
                <th>Oyuncu Boyu</th>
                <th>TakÄ±m OrtalamasÄ±</th>
                <th>Fark</th>
            </tr>
        </thead>
        <tbody>
            {% for stat in stats %}
            <tr>
                <td>{{ stat.player_name }}</td>
                <td>{{ stat.team_name }}</td>
                <td class="text-success fw-bold">{{ stat.player_height }}</td>
                <td>{{ stat.team_avg_height }}</td>
                <td>
                    {% if stat.diff > 0 %}
                    <span class="text-success">+{{ stat.diff }}</span>
                    {% else %}
                    {{ stat.diff }}
                    {% endif %}
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="text-center">Veri bulunamadÄ±.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <hr class="my-5">

    <div class="row">
        <!-- 1. En Skorer TakÄ±mÄ±n OyuncularÄ± -->
        <div class="col-md-4">
            <h4 class="text-primary">ğŸ† En Skorer TakÄ±m OyuncularÄ±</h4>
            <div class="alert alert-secondary small p-2">
                Ligin en Ã§ok puan atan takÄ±mÄ±nÄ± bulur (Nested Query).
            </div>
            <ul class="list-group">
                {% for p in top_scorer_players %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    {{ p[0] }}
                    <span class="badge bg-primary rounded-pill">{{ p[2] }}</span>
                </li>
                {% else %}
                <li class="list-group-item">Veri yok.</li>
                {% endfor %}
            </ul>
        </div>

        <!-- 2. Galibiyetsiz Hocalar -->
        <div class="col-md-4">
            <h4 class="text-danger">âŒ Galibiyetsiz Hocalar</h4>
            <div class="alert alert-secondary small p-2">
                HiÃ§ maÃ§ kazanmamÄ±ÅŸ takÄ±mlarÄ±n hocalarÄ±nÄ± listeler.
            </div>
            <table class="table table-sm table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Hoca AdÄ±</th>
                        <th>TakÄ±m</th>
                    </tr>
                </thead>
                <tbody>
                    {% for c in winless_coaches %}
                    <tr>
                        <td>{{ c[0] }}</td>
                        <td class="text-muted">{{ c[1] }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="2">ÅanslÄ± gÃ¼nÃ¼ndeyiz, herkes kazanmÄ±ÅŸ!</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- 3. MaÃ§ YapmamÄ±ÅŸ TakÄ±mlar -->
        <div class="col-md-4">
            <h4 class="text-warning">ğŸ’¤ Pasif TakÄ±mlar</h4>
            <div class="alert alert-secondary small p-2">
                FikstÃ¼rde (Matches tablosunda) yer almayan takÄ±mlar.
            </div>
            <table class="table table-sm table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>TakÄ±m</th>
                        <th>Lig</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in inactive_teams %}
                    <tr>
                        <td>{{ t[0] }}</td>
                        <td>{{ t[1] }}</td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="2">TÃ¼m takÄ±mlar aktif.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <br><br>
</div>
{% endblock %}